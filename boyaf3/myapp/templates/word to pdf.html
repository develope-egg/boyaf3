<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
    <meta charset="UTF-8">
    <title>Word to pdf</title>

    {% if request.user.is_authenticated %}
        <link rel="icon" href="https://cdn3d.iconscout.com/3d/premium/thumb/doc-file-5250548-4385836.png">
    {% else %}
        <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/888/888883.png">
    {% endif %}

    <link href='{% static 'main/Untitled-1.css' %}' rel="stylesheet" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="script.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/
    jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@8"></script>
<link href='{% static 'main/MENU.css' %}' rel="stylesheet" type="text/css">
    <script src="https://sweetalert.js.org/assets/js/index.js">
</script>
<script>
</script>
<style>
::-webkit-scrollbar {
       width: 20px;
}
::-webkit-scrollbar {
 width: 10px;
}
::-webkit-scrollbar-track {
 background: #00cc99;
 border-radius: 50px;
}
::-webkit-scrollbar-thumb {
 background: #00ff40;
 border-radius: 50px;
}
</style>
</head>

<body>
    <input type="checkbox" id="navi-toggle" class="checkbox" />
    <label for="navi-toggle" class="button">
      <span class="icon">&nbsp;</span>
    </label>
    <div class="background">&nbsp;</div>

    <!-- nav -->
    <nav class="nav">
      <ul class="list">
        <li class="item"> <a class="link"><icon><img  class="icon" src="house.png"/></icon></a> </li>
        <li class="item"> <a class="link" href="{% url 'index' %}"> Home </a> </li>
        <li class="item">  <a class="link" href="{% url 'tools' %}"> Tools </a> </li>
        <li class="item"> <a class="link" href=""> about </a> </li>
        <li class="item"> <a class="link" href="{% url 'login1' %}"> login </a> </li>
      </ul>
    </nav >
<div class="dynamic-shadow">
</br>
</br>
</br>
<div class="sc-1ttxsn1-0fxCLCz" ><div class="sc-1ttxsn1-1 hvHwmD"><div class="sc-17y9jfw-1 lpeKGy"><div class="sc-17y9jfw-5 qNym"><div class="sc-1gyxcpm-0 csDfHB sc-17y9jfw-4 iqUd" style="width:32px;height:32px"><svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 4C0 1.79086 1.79086 0 4 0H28C30.2091 0 32 1.79086 32 4V28C32 30.2091 30.2091 32 28 32H4C1.79086 32 0 30.2091 0 28V4Z" fill="#3D99F5"></path><rect x="7.5" y="7.5" width="10" height="13" stroke="white"></rect><path d="M18 11.5H24.5V24.5H14.5V20" stroke="white"></path><path d="M9 17.5H16" stroke="white"></path><path d="M9 15.5H16" stroke="white"></path><path d="M9 13.5H16" stroke="white"></path></svg></div></br></br><h1 id="hover-underline-animation"> PDF إلى WORD تحويل</h1></div></br></br><h2 id="hover-underline-animation"> أداة تحويل ملفات Word إلى PDF </h2></div></div></div>
</br></br>
<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="container">
        <div id="images"></div>
        <input type="file" id="file-input" accept="application/msword , application/vnd.openxmlformats-officedocument.wordprocessingml.document" name="files" onchange="preview()" >
        <label id="button" for="file-input">
            <i class="fas fa-upload"> Upload WORD</i>
        </label>
       <p id="number-of-img">No File selected yet </p>
    </div>
    <input type="text" id="bo" name="name" hidden>
    <input type="submit" id="submit" hidden>
</br>
</br>
    <button type="button" class="animated-border-button" onclick="y()">Submit</button>



    </div>
    </form>
    <noscript>'C:\Users\mrshn\PycharmProjects\djangoProject1\media\'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320"><path fill="#0099ff" fill-opacity="1" d="M0,128L48,128C96,128,192,128,288,112C384,96,480,64,576,48C672,32,768,32,864,53.3C960,75,1056,117,1152,128C1248,139,1344,117,1392,106.7L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path></svg></noscript>
    <div class="Project">
      <!-- https://brisseaux.tumblr.com/post/91018371936 -->
      <img src="https://mir-s3-cdn-cf.behance.net/project_modules/max_1200/41810341995087.57bd505fc7b34.gif" alt="" class="imgMasked" />
      <div class="Project-hail"></div>
      <div class="Project-hail2"></div>
      <p class="Project-name">Project name </p>
    </div>

    <div class="ae"></div>
    <script>
let fileInput = document.getElementById("file-input");
let imageContainer = document.getElementById("images");
let numberofImage = document.getElementById("number-of-img");
function preview(){
   imageContainer.innerHTML = "";
   for (i of fileInput.files){
     if(i.name.endsWith("docx") || i.name.endsWith("doc")){
       numberofImage.textContent=fileInput.files.length.toString()+'Files Selected';
        numberofImage.style.color = "black";
         let reader = new FileReader();
          let figure = document.createElement("figure");
          let figCap = document.createElement("figcaption");
         figCap.innerText = i.name;
         figure.appendChild(figCap);
         reader.onload=()=>{
               let img = document.createElement ("img");
              img.setAttribute("src", 'https://cdn.icon-icons.com/icons2/3053/PNG/512/microsoft_word_alt_macos_bigsur_icon_189946.png');
              figure.insertBefore(img, figCap);
         }
         imageContainer.appendChild(figure);
         reader.readAsDataURL(i);
        }
    else{
Swal.fire({
  title: "😬 اووبس",
  text: "🆗 لقد ادخلت صيغة ملف خاطئة لمعرفة الصيغ المتوفرة يرجى الضغط على ",
  icon: 'error',
  showCancelButton: true,
  confirmButtonColor: '#3085d6',
  cancelButtonColor: '#d33',
  confirmButtonText: 'Ok',
  backdrop: `
    rgba(0,0,123,0.4)

    `
}).then((result) => {
  if (result.isConfirmed) {
    Swal.fire(
      ':الصيغة المطلوبة',
      '{.PDF} ',
      'warning'
    )
  }
})
fileInput.value = '';
  }
}}
//url("https://c.tenor.com/hwe3vkln0_UAAAAC/error-x-error.gif")
function onclick() {
let sucsses=document.getElementsByClassName('dount');
sucsses.innerHTML=""
sucsses.setAttribute('style','align-items: center;text-align: center;')
let imgsucsses= sucsses.createElement('img');
imgsucsses.setAttribute('src','success.png')
img.setAttribute('style', 'align-items: center;text-align: center;')
}
function y(){
    Swal.fire({
title: "اسم الملف !",
text: "ادخل اسم الملف المخرج الذي تريده في الخانة ",
input: 'text',
showCancelButton: true ,
confirmButtonColor: 'green'
}).then((result) => {
if (result.value) {
   document.getElementById("bo").value= result.value;
   document.getElementById('submit').click()
Swal.fire({
  title: ' تم دمج الملفات  وتحميلها تلقائيا سوف يتم اعادة تحديث الصفحة تلقائيا',
  showConfirmButton: false,
  timer: 2000
})}
})}
//function myFunction(){
    //var w = window.outerWidth;
    //var h = window.outerHeight;
    //var myDiv = document.getElementsByClassName("donut");
   // myDiv.innerHTML = "";
   // myDiv.setAttribute("style","display: inline-block;border: 4px solid rgba(0, 0, 0, 0.1);border-left-color: #7983ff;border-radius: 50%;width: 30px;height: 30px;animation: donut-spin 1.2s linear infinite;align-items: center;text-align: center;  ");


//}
</script>
</div></div>
</body>
</html>